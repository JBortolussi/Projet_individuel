{% extends "base.html" %}
{% load static %}

{% block links %}
    <link rel="stylesheet" type="text/css" href="{% static 'taskmanager/css/project.css' %}">
{% endblock %}

{% block title %}- {{ project.name }} {% endblock %}

{% block line_path %}
    <li class="breadcrumb-item"><a href="{% url "projects" %}">Projets</a></li>
    <li class="breadcrumb-item active"><a href="{% url "project" project.id %}">{{ project.name }}</a></li>
{% endblock %}

{% block page %}
    <h2 style="display: inline">{{ project.name }}</h2>
    <button id="filter_button" type="button" style="margin-left: 3%" class="btn btn-primary">Filter</button>
    <a class="custom_link" href="{% url "newtask" project.id %}">
        <i data-toggle="tooltip" data-placement="left" title="Ajouter une tache" class="fas fa-plus-circle fa-3x"
           style="float: right;color: dodgerblue;"></i>
    </a>

    <div class="container-fluid" style="margin-top: 1%">
        <div class="unactive" id="row-filter">
            <form id="filter-form" action="" method="get">
                <input type="submit">
            </form>
            <button id="button-add" onclick="add_input()">add</button>
        </div>

        <div class="row" id="row-table">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>Task</th>
                    <th>Assignee</th>
                    <th>Start Date</th>
                    <th>Due Date</th>
                    <th>Priority</th>
                </tr>
                </thead>
                <tbody>
                {% for task in tasks %}
                    <tr>
                        <td><a class="custom_link" href="{% url "task" task.id %}">{{ task.name }}</a></td>
                        {% if task.assignee == None %}
                            <td><span class="badge badge-danger">Personne</span></td>
                        {% else %}
                            {% if not task.assignee.last_name %}
                                <td><span class="badge badge-primary p-2">{{ task.assignee.username }}</span></td>
                            {% else %}
                                <td><span
                                        class="badge badge-primary p-2">{{ task.assignee.first_name }} {{ task.assignee.last_name }}</span>
                                </td>
                            {% endif %}
                        {% endif %}

                        <td>{{ task.start_date }}</td>
                        <td>{{ task.due_date }}</td>
                        <td>{{ task.priority }}
                            <div style="float: right">
                                <a class="custom_link" href="{% url "edittask" task.id %}">
                                    <i data-toggle="tooltip" data-placement="left" title="Editer la tÃ¢che"
                                       class="fas fa-edit fa-2x" style="float: right;color: dodgerblue;"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>


    </div>
    <div class="container-fluid">
        <h5>Members of this project</h5>

        <ul class="list-group list-group-horizontal-md mt-3">
            {% for member in project.members.all %}
                <li class="list-group-item {% if member == user %}list-group-item-primary{% endif %}">{{ member }}</li>
            {% endfor %}
        </ul>
    </div>
    <script>
        let user_tab = [];
        {% for user in users %}
            user_tab.push(["{{user}}", "{{user.id}}"]);
        {% endfor %}
    </script>
    <script src="{% static 'taskmanager/js/project.js' %}"></script>
{% endblock %}

